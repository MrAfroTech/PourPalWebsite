<script>
    // Download function for Value Framework
    document.getElementById('download-pdf').addEventListener('click', function() {
      downloadPDF('ezdrink-value-framework.pdf');
    });
    
    function downloadPDF(filename) {
      // Show loading message
      showStatus('Generating PDF...', 'loading');
      
      try {
        const { jsPDF } = window.jspdf;
        
        // Get content to convert
        const element = document.getElementById('pdf-content');
        
        // Use html2canvas for conversion
        html2canvas(element, {
          scale: 2,
          useCORS: true,
          logging: false,
          allowTaint: true,
          backgroundColor: '#0a0a0a'
        }).then(function(canvas) {
          // Create PDF instance
          const pdf = new jsPDF({
            orientation: 'portrait',
            unit: 'px',
            format: 'letter'
          });
          
          // Get dimensions
          const imgData = canvas.toDataURL('image/jpeg', 1.0);
          const imgWidth = pdf.internal.pageSize.getWidth();
          const imgHeight = (canvas.height * imgWidth) / canvas.width;
          const pageHeight = pdf.internal.pageSize.getHeight();
          
          // Add black background to first page
          pdf.setFillColor(10, 10, 10);
          pdf.rect(0, 0, imgWidth, pageHeight, 'F');
          
          // Variables for adding image across multiple pages
          let position = 0;
          let heightLeft = imgHeight;
          
          // Add to first page
          pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
          heightLeft -= pageHeight;
          
          // Create additional pages if needed
          while (heightLeft > 0) {
            position = heightLeft - imgHeight;
            
            // Add new page
            pdf.addPage();
            
            // Add black background to new page
            pdf.setFillColor(10, 10, 10);
            pdf.rect(0, 0, imgWidth, pageHeight, 'F');
            
            // Add image with negative position to show the next portion
            pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
            
            heightLeft -= pageHeight;
          }
          
          // Save the PDF
          pdf.save(filename);
          
          // Show success message
          showStatus('PDF downloaded successfully!', 'success');
        }).catch(function(error) {
          console.error('Error creating canvas:', error);
          showStatus('Error generating PDF. Please try again.', 'error');
        });
      } catch (error) {
        console.error('Error generating PDF:', error);
        showStatus('Error generating PDF. Please try again.', 'error');
      }
    }
    
    function showStatus(message, type) {
      const statusMessage = document.getElementById('status-message');
      statusMessage.textContent = message;
      statusMessage.className = 'status-message ' + type;
      statusMessage.style.display = 'block';
      
      // Hide after 5 seconds
      setTimeout(() => {
        statusMessage.style.display = 'none';
      }, 5000);
    }
  </script>